<nav class="nav__list">
  {% if page.sidebar.title %}<h3 class="nav__title" style="padding-left: 0;">{{ page.sidebar.title }}</h3>{% endif %}
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">{{ site.data.ui-text[site.locale].menu_label | default: "Toggle Menu" }}</label>
  <ul class="nav__items">
    {% for navname in include.nav %}
      {% assign navigation = site.data.navigation[navname] %}
      {% for nav in navigation %}
        <li>
          {% comment %} 重要修复：分离链接和子菜单逻辑 {% endcomment %}
          {% if nav.children != null %}
            {% comment %} 有子菜单的情况 {% endcomment %}
            {% if nav.url %}
              {% comment %} 同时有链接和子菜单 {% endcomment %}
              <a href="{{ nav.url | relative_url }}" class="nav-parent-link">
                <span class="nav__sub-title">
                  {% assign title_key = nav.title %}
                  {{ site.data.ui-text[site.locale][title_key] | default: title_key }}
                </span>
              </a>
            {% else %}
              {% comment %} 只有子菜单，没有自身链接 {% endcomment %}
              <span class="nav__sub-title nav-parent">
                {% assign title_key = nav.title %}
                {{ site.data.ui-text[site.locale][title_key] | default: title_key }}
              </span>
            {% endif %}
            
            {% comment %} 子菜单列表 {% endcomment %}
            <ul class="nav-children">
              {% for child in nav.children %}
                <li>
                  <a href="{{ child.url | relative_url }}"{% if child.url == page.url %} class="active"{% endif %}>
                    {% assign child_key = child.title %}
                    {{ site.data.ui-text[site.locale][child_key] | default: child_key }}
                  </a>
                </li>
              {% endfor %}
            </ul>
            
          {% else %}
            {% comment %} 没有子菜单的普通链接 {% endcomment %}
            {% if nav.url %}
              <a href="{{ nav.url | relative_url }}">
                <span class="nav__sub-title">
                  {% assign title_key = nav.title %}
                  {{ site.data.ui-text[site.locale][title_key] | default: title_key }}
                </span>
              </a>
            {% else %}
              <span class="nav__sub-title">
                {% assign title_key = nav.title %}
                {{ site.data.ui-text[site.locale][title_key] | default: title_key }}
              </span>
            {% endif %}
          {% endif %}
        </li>
      {% endfor %}
    {% endfor %}
  </ul>
</nav>